<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="notificacion_vacacion_tree" model="ir.ui.view">
            <field name="name">notificacion_vacacion_tree</field>
            <field name="model">notificacion.vacacion</field>
            <field name="arch" type="xml">
                <tree create="true" decoration-success="state=='hold'" default_order="fecha_inicio_vacaciones asc, employee_id asc" edit="true" string="Notificaciones de Vacaciones">
                    <field invisible="True" name="state"/>
                    <field name="employee_id"/>
                    <field name="contract_date_start" optional="hide"/>
                    <field name="fecha_notificacion_vacaciones"/>
                    <field name="fecha_inicio_vacaciones"/>
                    <field name="dias_vacaciones"/>
                    <field invisible="True" name="currency_id"/>
                    <field name="payslip_net_amount" options="{'currency_field': 'currency_id'}" widget="monetary"/>
                    <field name="company_id"/>
                    <field name="state"/>
                </tree></field>
        </record>
        <record id="notificacion_vacacion_form" model="ir.ui.view">
            <field name="name">notificacion_vacacion_form</field>
            <field name="model">notificacion.vacacion</field>
            <field name="arch" type="xml">
                <form create="true" string="Notificación de Vacacion">
                    <header>
                        <button class="btn-primary" help="Crear la nómina para las vacaciones" invisible="state != 'hold'" name="generar_nominas" string="Crear nomina para vacaciones" type="object"/>
                        <button class="btn btn-default" help="Crear la notificación y elimina tanto la nómina como la ausencia" invisible="state != 'done'" name="cancelar_notificacion" string="Cancelar Notificación" type="object"/>
                        <field name="state" readonly="True" widget="statusbar"/>
                    </header>
                    <sheet>
                        <group>
                            <field name="employee_id" readonly="state == 'done'"/>
                            <field domain="[('employee_id','=',employee_id),('state','in',['open'])]" name="contract_id" options="{'no_create': True, 'no_create_edit':True}" readonly="state == 'done' or employee_id == False"/>
                            <field name="company_id" readonly="state == 'done'"/>
                            <field name="fecha_notificacion_vacaciones"/>
                            <field name="fecha_pago_vacaciones"/>
                            <field name="dias_vacaciones" readonly="state == 'done'"/>
                            <field name="fecha_inicio_vacaciones" readonly="state == 'done'"/>
                            <field name="fecha_fin_vacaciones" readonly="state == 'done'"/>
                            <field name="fecha_reincorporacion_vacaciones"/>
                            <field invisible="state != 'done'" name="payslip_id" readonly="state == 'done'"/>
                            <field invisible="state != 'done'" name="leave_id" readonly="state == 'done'"/>
                            <field name="periodo_usufructuado" readonly="state == 'done'"/>
                        </group>
                    </sheet>
                </form></field>
        </record>
        <record id="notificacion_vacacion_search" model="ir.ui.view">
            <field name="name">notificacion_vacacion_search</field>
            <field name="model">notificacion.vacacion</field>
            <field name="arch" type="xml">
                <search>
                    <field filter_domain="[('employee_id.name', 'ilike', self)]" name="employee_id"/>
                    <filter context="{'group_by': 'fecha_inicio_vacaciones'}" name="group_by_fecha_inicio" string="Fecha de inicio"/>
                    <filter context="{'group_by': 'state'}" name="group_by_state" string="Estado"/>
                </search></field>
        </record>
        <record id="notificacion_vacacion_action" model="ir.actions.act_window">
            <field name="name">Notificaciones de Vacaciones</field>
            <field name="res_model">notificacion.vacacion</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Las notificaciones de Vacaciones se crearán automáticamente
                </p></field>
        </record>
        <menuitem action="notificacion_vacacion_action" id="notificacion_vacacion_menuitem" name="Notificaciones de Vacaciones" parent="hr_payroll.menu_hr_payroll_payslips" sequence="16"/>
    </data>
</odoo>
