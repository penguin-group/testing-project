<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <!--        <record model="ir.ui.view" id="hr_attendance_calendar_calendar">-->
        <!--            <field name="name">hr_attendance_calendar_view_calendar</field>-->
        <!--            <field name="model">hr.attendance.calendar</field>-->
        <!--            <field name="arch" type="xml">-->
        <!--                <calendar js_class="hr_attendance_calendar_view_calendar_js" string="Planeamiento de Asistencias" event_open_popup="true" date_start="date_from" date_stop="date_to" mode="month" quick_add="False" show_unusual_days="True">-->
        <!--                    <field name="employee_id"/>-->
        <!--                </calendar>-->
        <!--            </field>-->
        <!--        </record>-->
        <record model="ir.ui.view" id="hr_attendance_calendar_tree">
            <field name="name">hr_attendance_calendar_view_tree</field>
            <field name="model">hr.attendance.calendar</field>
            <field name="arch" type="xml">
                <tree string="Planeamiento de Asistencias">
                    <field name="applied_on"/>
                    <field name="employee_id"/>
                    <field name="contract_id"/>
                    <field name="department_id"/>
                    <field name="company_id"/>
                    <field name="resource_calendar_id"/>
                    <field name="date_from"/>
                    <field name="date_to"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="hr_attendance_calendar_form">
            <field name="name">hr_attendance_calendar_view_form</field>
            <field name="model">hr.attendance.calendar</field>
            <field name="arch" type="xml">
                <form string="Planeamiento de Asistencias">
                    <sheet>
                        <group>
                            <group string="Aplicación">
                                <field name="applied_on"/>
                                <field name="employee_id" attrs="{'invisible':[('applied_on','!=','employee')],'required':[('applied_on','=','employee')]}"/>
                                <field name="contract_id" attrs="{'invisible':[('applied_on','!=','employee')],'required':[('applied_on','=','employee')]}"
                                       domain="[('employee_id','=',employee_id),('state','=','open')]"/>
                                <field name="department_id"
                                       attrs="{'invisible':[('applied_on','!=','department')],'required':[('applied_on','=','department')]}"/>
                            </group>
                            <group string="Horario">
                                <field name="resource_calendar_id"/>
                                <field name="date_from"/>
                                <field name="date_to"/>
                                <field name="attendance_calendar_conflict" invisible="True"/>
                                <field name="sequence"
                                       attrs="{'invisible':[('attendance_calendar_conflict','=',False)],'required':[('attendance_calendar_conflict','=',True)]}"/>
                            </group>
                        </group>
                        <span style="color:darkred;" attrs="{'invisible':[('attendance_calendar_conflict','=',False)]}">
                            Para el rango de fechas indicado existen más de un planeamiento, debe de establecer la prioridad de los mismos para la correcta
                            asignación de horarios en las asistencias
                        </span>
                    </sheet>
                </form>
            </field>
        </record>
        <record model="ir.ui.view" id="hr_attendance_calendar_search_view">
            <field name="name">hr_attendance_calendar_search_view</field>
            <field name="model">hr.attendance.calendar</field>
            <field name="arch" type="xml">
                <search>
                    <group expand="0" string="Group By">
                        <field name="employee_id" filter_domain="['|',('employee_id','ilike',self),('contract_id','ilike',self)]"/>
                        <field name="resource_calendar_id" filter_domain="[('resource_calendar_id','ilike',self)]"/>
                        <field name="company_id" filter_domain="[('company_id','ilike',self)]"/>
                        <filter string="Aplicar Sobre" name="group_by_applied_on" domain="[]" context="{'group_by':'applied_on'}"/>
                        <filter string="Departamento" name="group_by_department_id" domain="[]" context="{'group_by':'department_id'}"/>
                        <filter string="Compañía" name="group_by_company_id" domain="[]" context="{'group_by':'company_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="hr_attendance_calendar_action">
            <field name="name">Planeamiento de Asistencias</field>
            <field name="res_model">hr.attendance.calendar</field>
            <field name="view_mode">tree,form</field>
        </record>
        <menuitem
                name="Asistencias"
                id="rrhh_asistencias.menu_asistencias_padre"
                parent="hr_attendance.menu_hr_attendance_root"
        />
        <menuitem
                name="Planeamiento de Asistencias"
                id="hr_attendance_calendar_menuitem"
                parent="rrhh_asistencias.menu_asistencias_padre"
                action="hr_attendance_calendar_action"
        />

    </data>
</odoo>