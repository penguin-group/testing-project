<odoo>
    <data>
        <record id="rrhh_liquidacion.wizard_calculo_despido_form" model="ir.ui.view">
            <field name="name">wizard_calculo_despido__form</field>
            <field name="model">wizard.calculo.despido</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group string="Datos primarios">
                            <field name="employee_id" options="{'no_create': True, 'no_create_edit':True}"/>
                            <field name="contract_id" options="{'no_create': True, 'no_create_edit':True}"
                                   attrs="{'readonly':[('employee_id','=',False)],'required':[('employee_id','!=',False)]}"/>
                            <field name="fecha_inicio"/>
                            <field name="fecha_fin"/>
                        </group>
                        <div attrs="{'invisible':['|',('fecha_inicio','=',False),('fecha_fin','=',False)]}">
                            <group>
                                <field name="antiguedad"/>
                            </group>
                            <group>
                                <field name="posible_periodo_prueba" invisible="True"/>
                                <field name="periodo_prueba" attrs="{'invisible':[('posible_periodo_prueba','=',False)]}"/>
                                <field name="causa_justificada"/>
                            </group>
                            <group string="Modalidad de pagos">
                                <field name="tipo_empleado"/>
                            </group>
                            <div attrs="{'invisible':[('tipo_empleado','=',False)]}">
                                <group col="2" string="Salarios">
                                    <group>
                                        <field name="aporta_ips"/>
                                        <!--                                        <field name="aporta_amh"/>-->
                                        <field name="salario_promedio_ultimos_meses"/>
                                    </group>

                                    <group attrs="{'invisible':[('salario_promedio_ultimos_meses','=',True)]}">
                                        <field name="salario_mes_1"/>
                                        <field name="salario_mes_2"/>
                                        <field name="salario_mes_3"/>
                                        <field name="salario_mes_4"/>
                                        <field name="salario_mes_5"/>
                                        <field name="salario_mes_6"/>
                                    </group>
                                </group>
                            </div>
                            <div attrs="{'invisible':[('tipo_empleado','=',False)]}">
                                <group attrs="{'invisible':[('tipo_empleado','!=','30')]}">
                                    <field name="salario_promedio"
                                           attrs="{'invisible':['|',('tipo_empleado','=','24'),('salario_promedio_ultimos_meses','=',False)],'readonly':[('salario_promedio_ultimos_meses','=',False)]}"/>
                                </group>
                                <group>
                                    <field name="salario_promedio_diario"
                                           attrs="{'invisible':['&amp;',('salario_promedio_ultimos_meses','=',True),('tipo_empleado','=','30')],'readonly':[('tipo_empleado','!=','24')]}"/>
                                </group>
                                <!--                                <field name="testigo_id"/>-->
                            </div>
                            <div attrs="{'invisible':['|',('salario_promedio_diario','=',0),('tipo_empleado','=',False)]}">
                                <group string="Dias en el mes que aún no fueron abonados">
                                    <field name="dias_mes_aun_no_abonados"/>
                                </group>
                                <field name="posible_preaviso" invisible="True"/>
                                <group string="Preavisos" attrs="{'invisible':[('causa_justificada','=',True)]}">
                                    <field name="dias_preaviso_correspondido"/>
                                    <field name="dias_preaviso_recibido"/>
                                </group>
                                <group string="Vacaciones Causadas">
                                    <field name="vacaciones_causadas"/>
                                    <field name="vacaciones_gozadas"/>
                                </group>
                                <group string="Vacaciones Proporcionales" attrs="{'invisible':[('causa_justificada','=',True)]}">
                                    <field name="vacaciones_proporcionales_correspondientes"/>
                                    <field name="vacaciones_proporcionales_gozadas"/>
                                </group>
                                <group string="Vacaciones Acumuladas">
                                    <field name="vacaciones_acumuladas"/>
                                </group>
                                <group string="Otros Haberes y Deberes">
                                    <field name="otros_haberes"/>
                                    <field name="otros_deberes"/>
                                </group>
                                <div>
                                    <group string="Montos Finales" col="2">
                                        <group>
                                            <field name="show_liq_salario_dias_trabajados" readonly="True"/>
                                            <field name="show_liq_preaviso" attrs="{'invisible':[('periodo_prueba','=',True)]}" readonly="True"/>

                                            <label for="show_liq_indemnizacion" attrs="{'invisible':[('periodo_prueba','=',True)]}"/>
                                            <div class="o_row" name="indemnizacion" attrs="{'invisible':[('periodo_prueba','=',True)]}">
                                                <field name="show_liq_indemnizacion" readonly="True"/>
                                                <i>
                                                    <field name="show_liq_indemnizacion_dias" readonly="True"/>
                                                </i>
                                            </div>

                                            <field name="show_liq_vacaciones_causadas" readonly="True"/>
                                            <field name="show_liq_vacaciones_proporcionales" readonly="True"/>
                                            <field name="show_liq_vacaciones_acumuladas" readonly="True"/>
                                            <field name="show_liq_otros_haberes" readonly="True"/>
                                            <field name="show_liq_otros_deberes" readonly="True"/>
                                            <label for="show_liq_subtotal1"/>
                                            <b>
                                                <field name="show_liq_subtotal1" readonly="True"/>
                                            </b>
                                            <!--                                        <field name="show_liq_ips" readonly="True"/>-->
                                            <!--                                        <field name="show_liq_amh" readonly="True"/>-->
                                            <!--                                        <label for="show_liq_subtotal2"/>-->
                                            <!--                                        <b>-->
                                            <!--                                            <field name="show_liq_subtotal2" readonly="True"/>-->
                                            <!--                                        </b>-->
                                            <!--                                        <field name="show_liq_aguinaldo_proporcional" readonly="True"/>-->
                                            <!--                                        <label for="show_liq_total"/>-->
                                            <!--                                        <b>-->
                                            <!--                                            <field name="show_liq_total" readonly="True"/>-->
                                            <!--                                        </b>-->
                                            <field name="base_aguinaldo_proporcional"/>
                                        </group>
                                    </group>
                                </div>
                                <div>
                                    <strong style="color:red;">
                                        Las novedades no están incluidas en éstos calculos, dichas montos se añadirán en
                                        el siguiente paso
                                    </strong>
                                </div>

                                <div invisible="True">
                                    <group string="Montos Finales Ocultos">
                                        <field name="liq_salario_dias_trabajados"/>
                                        <field name="liq_preaviso" attrs="{'invisible':[('periodo_prueba','=',True)]}"/>
                                        <field name="liq_indemnizacion" attrs="{'invisible':[('periodo_prueba','=',True)]}"/>
                                        <field name="liq_vacaciones_causadas"/>
                                        <field name="liq_vacaciones_proporcionales"/>
                                        <field name="liq_vacaciones_acumuladas"/>
                                        <field name="liq_subtotal1"/>
                                        <field name="liq_ips"/>
                                        <!--                                        <field name="liq_amh"/>-->
                                        <field name="liq_subtotal2"/>
                                        <field name="liq_aguinaldo_proporcional"/>
                                        <field name="liq_total"/>
                                    </group>
                                </div>
                            </div>
                        </div>
                        <!--                    <footer>-->
                        <!--                        <button string="Guardar" class="oe_highlight" type="object"-->
                        <!--                                name="set_param_values"/>-->
                        <!--                        <button string="Cancelar" special="cancel"/>-->
                        <!--                    </footer>-->
                    </sheet>
                    <footer>
                        <button class="btn-danger" name="let_the_purge_begin"
                                confirm="Al confirmar, se creará la nómina con los montos especificados. Por favor no olvide confirmarla y dar de baja el contrato del empleado"
                                string="Crear nómina para Liquidación"
                                attrs="{'invisible':['|','|',('salario_promedio_diario','=',0),('contract_id','=',False),('fecha_fin','=',False)]}"
                                type="object"/>
                        <button string="Cancelar" class="oe_link" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record model="ir.actions.act_window" id="rrhh_liquidacion.wizard_calculo_despido_action">
            <field name="name">Cálculo de Despido</field>
            <field name="res_model">wizard.calculo.despido</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <menuitem name="Liquidacion de Funcionarios" id="rrhh_liquidacion.liquidacion_root" parent="hr_payroll.menu_hr_payroll_payslips" sequence="100"/>
        <menuitem name="Calculo de Despido" id="rrhh_liquidacion.wizard_calculo_despido_menuitem" parent="rrhh_liquidacion.liquidacion_root"
                  action="rrhh_liquidacion.wizard_calculo_despido_action"/>
    </data>

</odoo>
